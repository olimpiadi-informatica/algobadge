(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(6323)}])},9519:function(e,r,n){"use strict";n.d(r,{h:function(){return d},E:function(){return v}});var t=n(5893),o=n(674),i=n.n(o),a=n(885),s=n(3489),c=n(2050),l=n(4162);function u(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function d(e){var r=e.color;return r?(0,t.jsx)("svg",{fill:r,width:"35px",height:"35px",viewBox:"0 0 1024 1024",children:(0,t.jsx)("path",{d:"M547 304.2h-451l108.2-207.8h481.4z M685.6 754.4c0 95.656-77.544 173.2-173.2 173.2s-173.2-77.544-173.2-173.2c0-95.656 77.544-173.2 173.2-173.2s173.2 77.544 173.2 173.2z M697.8 598.2l230.2-294-138.6-207.8-276.6 415.6c64.6 0 125.4 25.4 171 71 5 5 9.6 10 14 15.2z M411.6 533.2l-107-161.2h-207.8l180.2 323c10.4-42.4 32.2-81.2 64-112.8 20.8-20.6 44.6-37.2 70.6-49z"})}):null}function f(e){var r=e.color;return(0,t.jsx)("svg",{width:"35px",height:"35px",viewBox:"0 0 170 170",children:(0,t.jsxs)("g",{children:[(0,t.jsx)("path",{style:{fillRule:"evenodd",fill:r},d:"m112.5 4.1909c-20.072 0-36.231 16.159-36.231 36.231v40.256h10.064v-40.256c0-14.497 11.671-26.167 26.167-26.167 14.5 0 26.17 11.67 26.17 26.167v27.756h10.06v-27.756c0-20.072-16.16-36.231-36.23-36.231z"}),(0,t.jsx)("rect",{style:{fillRule:"evenodd",fill:r},rx:"0.5",ry:".5",height:"66.259",width:"85.603",y:"74.55",x:"7.1987"})]})})}function h(e){var r=e.withUnlock,n=[{position:a.Rc,color:a.Iy},{position:a.tY,color:a.sI},{position:a.Ko,color:a.qs}];return(0,t.jsxs)(t.Fragment,{children:[r&&(0,t.jsx)("div",{className:i().checkpoint,style:{"--position":"".concat(100*a.Lw,"%")},children:(0,t.jsx)(f,{color:"black"})}),n.map((function(e){return(0,t.jsx)("div",{className:i().checkpoint,style:{"--position":"".concat(100*e.position,"%")},children:(0,t.jsx)(d,{color:e.color})},e.position)}))]})}function v(e){var r=e.score,n=e.numTasks,o=e.nextCategories;if(r===n*a.O1)return(0,t.jsx)("div",{className:i().progress,children:(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(c.Z,{className:i().progressGold,animated:!0,now:100}),(0,t.jsx)(h,{withUnlock:o.length>0})]})});var d=[],f=[{from:a.tY,to:a.Ko,className:i().progressSilver},{from:a.Rc,to:a.tY,className:i().progressBronze},{from:0,to:a.Rc,className:i().progressNone}],v=r/n/a.O1,p=!0,g=!1,m=void 0;try{for(var y,b=f[Symbol.iterator]();!(p=(y=b.next()).done);p=!0){var x=y.value;if(v>=x.from){d.push((0,t.jsx)(c.Z,{className:x.className,animated:!0,now:100*v},x.from));break}}}catch(_){g=!0,m=_}finally{try{p||null==b.return||b.return()}finally{if(g)throw m}}return(0,t.jsx)(l.Z,{placement:"top",overlay:function(e){var i="";if(v<a.Lw&&o.length>0)i="Ancora ".concat(n*a.O1*a.Lw-r," punti per sbloccare le prossime categorie");else if(v<a.Rc)i="Ancora ".concat(n*a.O1*a.Rc-r," punti per sbloccare il badge di bronzo!");else if(v<a.tY)i="Ancora ".concat(n*a.O1*a.tY-r," punti per sbloccare il badge di argento!");else{if(!(v<a.Ko))return null;i="Ancora ".concat(n*a.O1*a.Ko-r," punti per sbloccare il badge d'oro!")}return(0,t.jsx)(s.Z,function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){u(e,r,n[r])}))}return e}({id:"progress-overlay"},e,{children:i}))},children:(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:i().progress,children:(0,t.jsxs)(c.Z,{children:[d,(0,t.jsx)(h,{withUnlock:o.length>0})]})})})})}},885:function(e,r,n){"use strict";n.d(r,{O1:function(){return t},Lw:function(){return o},Rc:function(){return i},tY:function(){return a},Ko:function(){return s},Iy:function(){return c},sI:function(){return l},qs:function(){return u},Cj:function(){return f},Yf:function(){return v},Pb:function(){return p}});var t=100,o=.25,i=.5,a=.75,s=1,c="#cd7f32",l="#c0c0c0",u="#ffdf00";function d(e){switch(e){case"locked":return 0;case"none":return 1;case"bronze":return 2;case"silver":return 3;case"gold":return 4}}function f(e){switch(e){case"locked":case"none":return null;case"bronze":return c;case"silver":return l;case"gold":return u}}function h(e,r){return e>=t*r*s?"gold":e>=t*r*a?"silver":e>=t*r*i?"bronze":"none"}function v(e,r,n){var i={},a=Object.fromEntries(r.scores.map((function(e){return[e.name,e.score]}))),s=!0,c=!1,l=void 0;try{for(var u,d=e.nodes[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var f=u.value,v=0,p={},g=!0,m=!1,y=void 0;try{for(var b,x=f.tasks[Symbol.iterator]();!(g=(b=x.next()).done);g=!0){var _,j=b.value,w=null!==(_=a[j.name])&&void 0!==_?_:0;p[j.name]=w,v+=w}}catch(C){m=!0,y=C}finally{try{g||null==x.return||x.return()}finally{if(m)throw y}}i[f.id]={node:f,score:v,badge:h(v,f.tasks.length),tasks:p}}}catch(C){c=!0,l=C}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}var k=new Set,N=function(e){if(!k.has(e)){k.add(e);var r=i[e],a=!1,s=!0,c=!1,l=void 0;try{for(var u,d=r.node.prerequisites[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var f=u.value;N(f);var h=i[f],v=h.node.tasks.length*t*o;("locked"===h.badge||h.score<v)&&(a=!0)}}catch(C){c=!0,l=C}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}a&&!n&&(r.badge="locked")}},O=!0,S=!1,P=void 0;try{for(var z,T=e.nodes[Symbol.iterator]();!(O=(z=T.next()).done);O=!0){var A=z.value;N(A.id)}}catch(C){S=!0,P=C}finally{try{O||null==T.return||T.return()}finally{if(S)throw P}}return i}function p(e){var r=Object.values(e).map((function(e){return e.badge})),n="gold",t=!0,o=!1,i=void 0;try{for(var a,s=r[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var c=a.value;d(c)<d(n)&&(n=c)}}catch(l){o=!0,i=l}finally{try{t||null==s.return||s.return()}finally{if(o)throw i}}return n}},2106:function(e,r,n){"use strict";n.d(r,{b:function(){return s}});var t=n(4051),o=n.n(t);function i(e,r,n,t,o,i,a){try{var s=e[i](a),c=s.value}catch(l){return void n(l)}s.done?r(c):Promise.resolve(c).then(t,o)}function a(e){return function(){var r=this,n=arguments;return new Promise((function(t,o){var a=e.apply(r,n);function s(e){i(a,t,o,s,c,"next",e)}function c(e){i(a,t,o,s,c,"throw",e)}s(void 0)}))}}function s(e){return c.apply(this,arguments)}function c(){return(c=a(o().mark((function e(r){var n,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={action:"get",username:r},e.next=4,fetch("https://training.olinfo.it/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"});case 4:if(200===(t=e.sent).status){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,t.json();case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}},6323:function(e,r,n){"use strict";n.r(r),n.d(r,{__N_SSG:function(){return X},default:function(){return D}});var t=n(5893),o=n(885),i=n(4408),a=n.n(i),s=n(9655),c=n(7294),l=n(9519);function u(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function d(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);a=!0);}catch(c){s=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return u(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){var r=e.tasks,n=function(e){var r=e.task,n=e.score;return(0,t.jsxs)("li",{children:[(0,t.jsx)("a",{href:"https://training.olinfo.it/#/task/".concat(r,"/statement"),rel:"noreferrer",target:"_blank",children:r})," ","(",n," / ",o.O1,")"]})};return(0,t.jsx)("ul",{children:Object.entries(r).map((function(e){var r=d(e,2),o=r[0],i=r[1];return(0,t.jsx)(n,{task:o,score:i},o)}))})}function h(e){var r=e.badge,n=e.badges,i=r.node.prerequisites.map((function(e){return Object.keys(n[e].tasks).length*o.O1})),c=r.node.tasks.length,u=Object.values(n).filter((function(e){return e.node.prerequisites.includes(r.node.id)})).map((function(e){return e.node.id}));return(0,t.jsxs)("div",{className:a().category,children:[(0,t.jsx)("h2",{className:a().title,children:r.node.title}),"locked"!==r.badge?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.E,{score:r.score,numTasks:c,nextCategories:u}),(0,t.jsx)("div",{className:a().taskList,children:(0,t.jsx)(f,{tasks:r.tasks})}),(0,t.jsx)("div",{className:a().resources,children:(0,t.jsx)(s.D,{components:{h1:"h3",h2:"h4",h3:"h5",h4:"h6"},children:r.node.resources_md})})]}):(0,t.jsxs)("p",{children:["Questa categoria \xe8 bloccata! Totalizza almeno"," ",i[0]*o.Lw," punti in"," ",(0,t.jsx)("code",{children:r.node.prerequisites})," per sbloccarla."]})]})}var v=n(2914),p=n.n(v);function g(e){var r=e.url,n=r.startsWith("https://")?r:"https:".concat(r);return(0,t.jsx)("img",{className:p().profilePicture,src:n,alt:""})}var m=n(1829),y=n.n(m),b=n(4184),x=n.n(b),_=n(1949),j=n.n(_);function w(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function k(e){var r=e.badge,n="gold"===r,o=n||"silver"===r,i=o||"bronze"===r;return(0,t.jsxs)("span",{className:j().title,children:[(0,t.jsx)("span",{className:x()(j().initial,w({},j().hasSilver,o)),children:"A"}),"LG",(0,t.jsx)("span",{className:x()(w({},j().hasGold,n)),children:"O"}),(0,t.jsx)("span",{className:x()(j().initial,w({},j().hasBronze,i)),children:"B"}),"ADGE"]})}function N(e){var r=e.user,n=e.badge,i=e.impersonated;return(0,t.jsxs)("div",{className:y().header,children:[(0,t.jsxs)("div",{className:y().title,children:[(0,t.jsx)(k,{badge:n})," ",(0,t.jsx)(l.h,{color:(0,o.Cj)(n)})]}),"Ciao"," ",(0,t.jsx)(g,{url:"//gravatar.com/avatar/".concat(r.mail_hash,"?d=identicon")}),(0,t.jsxs)("strong",{children:[r.first_name," ",r.last_name]}),"!"," ",i?(0,t.jsx)("em",{children:"(impersonato)"}):(0,t.jsxs)("em",{children:["(Login effettuato tramite"," ",(0,t.jsx)("a",{href:"https://training.olinfo.it",children:"training.olinfo.it"}),")"]})]})}var O=n(8707),S=n.n(O);function P(){return(0,t.jsxs)("div",{className:S().loading,children:[(0,t.jsx)("img",{src:"/loading.gif",alt:"Loading..."}),"caricamento..."]})}function z(){return(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{children:"Login richiesto"}),(0,t.jsxs)("p",{children:["Per usare algobadge devi essere loggato su"," ",(0,t.jsx)("a",{href:"https://training.olinfo.it/",children:"https://training.olinfo.it/"})]})]})}var T=n(5532),A=n.n(T),C=function(e){var r=e.getBoundingClientRect();return{left:r.left+window.pageXOffset,top:r.top+window.pageYOffset,width:r.width||e.offsetWidth,height:r.height||e.offsetHeight}};function E(e){var r=e.start,n=e.end,o=C(r),i=C(n),a=o.left+o.width/2,s=o.top+o.height/2,c=i.left+i.width/2,l=i.top+i.height/2,u=Math.sqrt((c-a)*(c-a)+(l-s)*(l-s)),d=(a+c)/2-u/2,f=(s+l)/2-1,h=Math.atan2(s-l,a-c)*(180/Math.PI),v={"--color":"black","--thickness":"".concat(2,"px"),"--cx":"".concat(d,"px"),"--cy":"".concat(f,"px"),"--length":"".concat(u,"px"),"--angle":"".concat(h,"deg")};return(0,t.jsx)("div",{className:A().line,style:v})}var L=n(695),R=n.n(L),q={locked:"#eee",none:"#fff",bronze:"#cd7f32",silver:"#c0c0c0",gold:"#ffdf00"},I={locked:"#bbb",none:"#000",bronze:"#523214",silver:"#4c4c4c",gold:"#665900"};function Y(e){var r=e.node,n=e.onClick,i={"--row":r.node.position[1],"--column":r.node.position[0],"--color":q[r.badge],"--text-color":I[r.badge]},a=r.node.tasks.length*o.O1;return(0,t.jsx)("div",{className:R().node,style:i,children:(0,t.jsxs)("button",{"data-node-id":r.node.id,className:R().badge,onClick:n,children:[(0,t.jsx)("div",{className:R().badgeName,children:r.node.id}),(0,t.jsxs)("div",{className:R().score,children:[r.score," / ",a]})]})})}function B(e){var r=e.badges,n=e.setSelectedNode,o=(0,c.useRef)(null),i=(0,c.useState)(null),a=i[0],s=i[1],l=(0,c.useState)([]),u=l[0],d=l[1];(0,c.useEffect)((function(){if(null!==o.current){var e=o.current.querySelectorAll(".".concat(R().badge)),r=Object.fromEntries(Array.from(e.values()).map((function(e){return[e.getAttribute("data-node-id"),e]})));s(r)}}),[]);var f=(0,c.useCallback)((function(){if(a){var e=[],n=!0,t=!1,o=void 0;try{for(var i,s=Object.values(r)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value,l=!0,u=!1,f=void 0;try{for(var h,v=c.node.prerequisites[Symbol.iterator]();!(l=(h=v.next()).done);l=!0){var p=h.value,g=a[c.node.id],m=a[p];e.push({id:"".concat(c.node.id,"-").concat(p),start:g,end:m})}}catch(y){u=!0,f=y}finally{try{l||null==v.return||v.return()}finally{if(u)throw f}}}}catch(y){t=!0,o=y}finally{try{n||null==s.return||s.return()}finally{if(t)throw o}}d(e)}}),[r,a]);(0,c.useEffect)((function(){f()}),[r,f]),(0,c.useEffect)((function(){return window.addEventListener("resize",f),function(){return window.removeEventListener("resize",f)}}),[f]);var h=Object.values(r);return(0,t.jsxs)("div",{className:R().tree,ref:o,children:[h.map((function(e){return(0,t.jsx)(Y,{node:e,onClick:function(){return n(e.node.id)}},e.node.id)})),u.map((function(e){return(0,t.jsx)(E,{start:e.start,end:e.end},e.id)}))]})}var G=n(6489),M=n(1163);function U(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function Z(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);a=!0);}catch(c){s=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return U(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(){var e=(0,M.useRouter)(),r=(0,c.useState)(void 0),n=r[0],t=r[1];return(0,c.useEffect)((function(){if(e.isReady)if(e.query.impersonate){var r={username:e.query.impersonate,impersonated:!0};console.log("Impersonating",r),t(r)}else{var n=function(){var e=G.parse(window.document.cookie);if(!e.token)return null;var r=Z(e.token.split("."),3),n=(r[0],r[1]);r[2];try{var t=n.replace(/-/g,"+").replace(/_/g,"/"),o=atob(t);return JSON.parse(o)}catch(i){return null}}();console.log("User is",n),t(n)}}),[e.query.impersonate,e.isReady]),n}var K=n(2106),X=!0;function D(e){var r,n,i=e.taskGraph,a=(0,M.useRouter)(),s=W(),l=(0,c.useState)(void 0),u=l[0],d=l[1],f=(0,c.useState)(null!==(n=null===(r=i.nodes.find((function(e){return 0===e.prerequisites.length})))||void 0===r?void 0:r.id)&&void 0!==n?n:""),v=f[0],p=f[1];if((0,c.useEffect)((function(){null===s&&d(null),s&&(0,K.b)(s.username).then((function(e){return d(e)}))}),[s]),void 0===s||void 0===u)return(0,t.jsx)(P,{});if(null===s||null===u)return(0,t.jsx)(z,{});var g="true"===a.query.unlock,m=(0,o.Yf)(i,u,g),y=(0,o.Pb)(m);return(0,t.jsxs)("div",{children:[(0,t.jsx)(N,{user:u,badge:y,impersonated:s.impersonated}),(0,t.jsx)(B,{badges:m,setSelectedNode:p}),v in m&&(0,t.jsx)(h,{badge:m[v],badges:m})]})}},4408:function(e){e.exports={category:"Category_category__yzdBd",title:"Category_title__8klu6",taskList:"Category_taskList__uYCvW",resources:"Category_resources__dqPOc"}},674:function(e){e.exports={progressNone:"Progress_progressNone__o_ttj",progressBronze:"Progress_progressBronze__TJD81",progressSilver:"Progress_progressSilver__LQ8l3",progressGold:"Progress_progressGold__7qQo3",progress:"Progress_progress__axvfY",checkpoint:"Progress_checkpoint__TZ_n2"}},1829:function(e){e.exports={header:"Header_header__RW35m",title:"Header_title__GPS8b"}},2914:function(e){e.exports={profilePicture:"ProfilePicture_profilePicture__YaIyJ"}},8707:function(e){e.exports={loading:"Loading_loading__PXEn4"}},1949:function(e){e.exports={title:"Title_title__CfOW_",initial:"Title_initial__TIYiy",hasGold:"Title_hasGold__zVY3T",hasSilver:"Title_hasSilver__E28iz",hasBronze:"Title_hasBronze__96yho"}},5532:function(e){e.exports={line:"Line_line__C9XiF"}},695:function(e){e.exports={tree:"Tree_tree__UfTc3",node:"Tree_node__fgN5z",badge:"Tree_badge__VAWxQ",badgeName:"Tree_badgeName__UP_Ry",score:"Tree_score__RxP9M"}}},function(e){e.O(0,[592,751,774,888,179],(function(){return r=5301,e(e.s=r);var r}));var r=e.O();_N_E=r}]);