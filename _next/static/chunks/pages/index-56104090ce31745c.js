(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(7838)}])},7838:function(e,r,t){"use strict";t.r(r),t.d(r,{__N_SSG:function(){return ne},default:function(){return oe}});var n=t(5893),o=100,i=.25,a=.5,s=.75;function c(e,r){return e>=o*r*1?"gold":e>=o*r*s?"silver":e>=o*r*a?"bronze":"none"}var l=t(4408),u=t.n(l),d=t(9655),f=t(7294),h=t(674),p=t.n(h),v=t(3489),g=t(2050),m=t(4162);function y(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function x(e){var r=e.color;return(0,n.jsx)("svg",{fill:r,width:"35px",height:"35px",viewBox:"0 0 1024 1024",children:(0,n.jsx)("path",{d:"M547 304.2h-451l108.2-207.8h481.4z M685.6 754.4c0 95.656-77.544 173.2-173.2 173.2s-173.2-77.544-173.2-173.2c0-95.656 77.544-173.2 173.2-173.2s173.2 77.544 173.2 173.2z M697.8 598.2l230.2-294-138.6-207.8-276.6 415.6c64.6 0 125.4 25.4 171 71 5 5 9.6 10 14 15.2z M411.6 533.2l-107-161.2h-207.8l180.2 323c10.4-42.4 32.2-81.2 64-112.8 20.8-20.6 44.6-37.2 70.6-49z"})})}function b(e){var r=e.color;return(0,n.jsx)("svg",{width:"35px",height:"35px",viewBox:"0 0 170 170",children:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{style:{fillRule:"evenodd",fill:r},d:"m112.5 4.1909c-20.072 0-36.231 16.159-36.231 36.231v40.256h10.064v-40.256c0-14.497 11.671-26.167 26.167-26.167 14.5 0 26.17 11.67 26.17 26.167v27.756h10.06v-27.756c0-20.072-16.16-36.231-36.23-36.231z"}),(0,n.jsx)("rect",{style:{fillRule:"evenodd",fill:r},rx:"0.5",ry:".5",height:"66.259",width:"85.603",y:"74.55",x:"7.1987"})]})})}function j(e){var r=e.withUnlock,t=[{position:a,color:"#cd7f32"},{position:s,color:"#c0c0c0"},{position:1,color:"#ffdf00"}];return(0,n.jsxs)(n.Fragment,{children:[r&&(0,n.jsx)("div",{className:p().checkpoint,style:{"--position":"".concat(25,"%")},children:(0,n.jsx)(b,{color:"black"})}),t.map((function(e){return(0,n.jsx)("div",{className:p().checkpoint,style:{"--position":"".concat(100*e.position,"%")},children:(0,n.jsx)(x,{color:e.color})},e.position)}))]})}function _(e){var r=e.score,t=e.numTasks,c=e.nextCategories;if(r===t*o)return(0,n.jsx)("div",{className:p().progress,children:(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(g.Z,{className:p().progressGold,animated:!0,now:100}),(0,n.jsx)(j,{withUnlock:c.length>0})]})});var l=[],u=[{from:s,to:1,className:p().progressSilver},{from:a,to:s,className:p().progressBronze},{from:0,to:a,className:p().progressNone}],d=r/t/o,f=!0,h=!1,x=void 0;try{for(var b,_=u[Symbol.iterator]();!(f=(b=_.next()).done);f=!0){var w=b.value;if(d>=w.from){l.push((0,n.jsx)(g.Z,{className:w.className,animated:!0,now:100*d},w.from));break}}}catch(k){h=!0,x=k}finally{try{f||null==_.return||_.return()}finally{if(h)throw x}}return(0,n.jsx)(m.Z,{placement:"top",overlay:function(e){var l="";if(d<i&&c.length>0)l="Ancora ".concat(t*o*i-r," punti per sbloccare le prossime categorie");else if(d<a)l="Ancora ".concat(t*o*a-r," punti per sbloccare il badge di bronzo!");else if(d<s)l="Ancora ".concat(t*o*s-r," punti per sbloccare il badge di argento!");else{if(!(d<1))return null;l="Ancora ".concat(t*o*1-r," punti per sbloccare il badge d'oro!")}return(0,n.jsx)(v.Z,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){y(e,r,t[r])}))}return e}({id:"progress-overlay"},e,{children:l}))},children:(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:p().progress,children:(0,n.jsxs)(g.Z,{children:[l,(0,n.jsx)(j,{withUnlock:c.length>0})]})})})})}function w(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function k(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i=[],a=!0,s=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(c){s=!0,o=c}finally{try{a||null==t.return||t.return()}finally{if(s)throw o}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return w(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return w(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e){var r=e.tasks,t=function(e){var r=e.task,t=e.score;return(0,n.jsxs)("li",{children:[(0,n.jsx)("a",{href:"https://training.olinfo.it/#/task/".concat(r,"/statement"),rel:"noreferrer",target:"_blank",children:r})," ","(",t," / ",o,")"]})};return(0,n.jsx)("ul",{children:Object.entries(r).map((function(e){var r=k(e,2),o=r[0],i=r[1];return(0,n.jsx)(t,{task:o,score:i},o)}))})}function S(e){var r=e.badge,t=e.badges,a=r.node.prerequisites.map((function(e){return Object.keys(t[e].tasks).length*o})),s=r.node.tasks.length,c=Object.values(t).filter((function(e){return e.node.prerequisites.includes(r.node.id)})).map((function(e){return e.node.id}));return(0,n.jsxs)("div",{className:u().category,children:[(0,n.jsx)("h2",{className:u().title,children:r.node.title}),"locked"!==r.badge?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_,{score:r.score,numTasks:s,nextCategories:c}),(0,n.jsx)("div",{className:u().taskList,children:(0,n.jsx)(N,{tasks:r.tasks})}),(0,n.jsx)("div",{className:u().resources,children:(0,n.jsx)(d.D,{components:{h1:"h3",h2:"h4",h3:"h5",h4:"h6"},children:r.node.resources_md})})]}):(0,n.jsxs)("p",{children:["Questa categoria \xe8 bloccata! Totalizza almeno"," ",a[0]*i," punti in"," ",(0,n.jsx)("code",{children:r.node.prerequisites})," per sbloccarla."]})]})}var O=t(2914),P=t.n(O);function A(e){var r=e.url,t=r.startsWith("https://")?r:"https:".concat(r);return(0,n.jsx)("img",{className:P().profilePicture,src:t,alt:""})}var C=t(1829),z=t.n(C);function E(e){var r=e.user;return(0,n.jsxs)("div",{className:z().header,children:["Ciao ",(0,n.jsx)(A,{url:r.picture}),(0,n.jsxs)("strong",{children:[r.firstName," ",r.lastName]}),"!"," ",(0,n.jsxs)("em",{children:["(Login effettuato tramite"," ",(0,n.jsx)("a",{href:"https://training.olinfo.it",children:"training.olinfo.it"}),")"]})]})}var T=t(8707),q=t.n(T);function L(){return(0,n.jsxs)("div",{className:q().loading,children:[(0,n.jsx)("img",{src:"/loading.gif",alt:"Loading..."}),"caricamento..."]})}function M(){return(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Login richiesto"}),(0,n.jsxs)("p",{children:["Per usare algobadge devi essere loggato su"," ",(0,n.jsx)("a",{href:"https://training.olinfo.it/",children:"https://training.olinfo.it/"})]})]})}var I=t(5532),R=t.n(I),B=function(e){var r=e.getBoundingClientRect();return{left:r.left+window.pageXOffset,top:r.top+window.pageYOffset,width:r.width||e.offsetWidth,height:r.height||e.offsetHeight}};function U(e){var r=e.start,t=e.end,o=B(r),i=B(t),a=o.left+o.width/2,s=o.top+o.height/2,c=i.left+i.width/2,l=i.top+i.height/2,u=Math.sqrt((c-a)*(c-a)+(l-s)*(l-s)),d=(a+c)/2-u/2,f=(s+l)/2-1,h=Math.atan2(s-l,a-c)*(180/Math.PI),p={"--color":"black","--thickness":"".concat(2,"px"),"--cx":"".concat(d,"px"),"--cy":"".concat(f,"px"),"--length":"".concat(u,"px"),"--angle":"".concat(h,"deg")};return(0,n.jsx)("div",{className:R().line,style:p})}var Z=t(695),G=t.n(Z),W={locked:"#eee",none:"#fff",bronze:"#cd7f32",silver:"#c0c0c0",gold:"#ffdf00"},X={locked:"#bbb",none:"#000",bronze:"#523214",silver:"#4c4c4c",gold:"#665900"};function J(e){var r=e.node,t=e.onClick,i={"--row":r.node.position[1],"--column":r.node.position[0],"--color":W[r.badge],"--text-color":X[r.badge]},a=r.node.tasks.length*o;return(0,n.jsx)("div",{className:G().node,style:i,children:(0,n.jsxs)("button",{"data-node-id":r.node.id,className:G().badge,onClick:t,children:[(0,n.jsx)("div",{className:G().badgeName,children:r.node.id}),(0,n.jsxs)("div",{className:G().score,children:[r.score," / ",a]})]})})}function Q(e){var r=e.badges,t=e.setSelectedNode,o=(0,f.useRef)(null),i=(0,f.useState)(null),a=i[0],s=i[1],c=(0,f.useState)([]),l=c[0],u=c[1];(0,f.useEffect)((function(){if(null!==o.current){var e=o.current.querySelectorAll(".".concat(G().badge)),r=Object.fromEntries(Array.from(e.values()).map((function(e){return[e.getAttribute("data-node-id"),e]})));s(r)}}),[]);var d=(0,f.useCallback)((function(){if(a){var e=[],t=!0,n=!1,o=void 0;try{for(var i,s=Object.values(r)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var c=i.value,l=!0,d=!1,f=void 0;try{for(var h,p=c.node.prerequisites[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var v=h.value,g=a[c.node.id],m=a[v];e.push({id:"".concat(c.node.id,"-").concat(v),start:g,end:m})}}catch(y){d=!0,f=y}finally{try{l||null==p.return||p.return()}finally{if(d)throw f}}}}catch(y){n=!0,o=y}finally{try{t||null==s.return||s.return()}finally{if(n)throw o}}u(e)}}),[r,a]);(0,f.useEffect)((function(){d()}),[r,d]),(0,f.useEffect)((function(){return window.addEventListener("resize",d),function(){return window.removeEventListener("resize",d)}}),[d]);var h=Object.values(r);return(0,n.jsxs)("div",{className:G().tree,ref:o,children:[h.map((function(e){return(0,n.jsx)(J,{node:e,onClick:function(){return t(e.node.id)}},e.node.id)})),l.map((function(e){return(0,n.jsx)(U,{start:e.start,end:e.end},e.id)}))]})}var Y=t(6489),D=t(1163);function F(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function H(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i=[],a=!0,s=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(c){s=!0,o=c}finally{try{a||null==t.return||t.return()}finally{if(s)throw o}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return F(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return F(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(){var e=(0,D.useRouter)(),r=(0,f.useState)(void 0),t=r[0],n=r[1];return(0,f.useEffect)((function(){var r;e.query.impersonate?(console.log("Impersonating",e.query.impersonate),n({username:r=e.query.impersonate,picture:"",firstName:r,lastName:"",email:"",id:0})):n(function(){var e=Y.parse(window.document.cookie);if(!e.token)return null;var r=H(e.token.split("."),3),t=(r[0],r[1]);r[2];try{var n=t.replace(/-/g,"+").replace(/_/g,"/"),o=atob(n);return JSON.parse(o)}catch(i){return null}}())}),[e.query.impersonate]),t}var V=t(4051),K=t.n(V);function ee(e,r,t,n,o,i,a){try{var s=e[i](a),c=s.value}catch(l){return void t(l)}s.done?r(c):Promise.resolve(c).then(n,o)}function re(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var i=e.apply(r,t);function a(e){ee(i,n,o,a,s,"next",e)}function s(e){ee(i,n,o,a,s,"throw",e)}a(void 0)}))}}function te(){return(te=re(K().mark((function e(r){var t,n;return K().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={action:"get",username:r},e.next=4,fetch("https://training.olinfo.it/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});case 4:if(200===(n=e.sent).status){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,n.json();case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}var ne=!0;function oe(e){var r,t,a=e.taskGraph,s=(0,D.useRouter)(),l=$(),u=(0,f.useState)(void 0),d=u[0],h=u[1],p=(0,f.useState)(null!==(t=null===(r=a.nodes.find((function(e){return 0===e.prerequisites.length})))||void 0===r?void 0:r.id)&&void 0!==t?t:""),v=p[0],g=p[1];if((0,f.useEffect)((function(){null===l&&h(null),l&&function(e){return te.apply(this,arguments)}(l.username).then((function(e){return h(e)}))}),[l]),void 0===l||void 0===d)return(0,n.jsx)(L,{});if(null===l||null===d)return(0,n.jsx)(M,{});var m=function(e,r,t){var n={},a=Object.fromEntries(r.scores.map((function(e){return[e.name,e.score]}))),s=!0,l=!1,u=void 0;try{for(var d,f=e.nodes[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var h=d.value,p=0,v={},g=!0,m=!1,y=void 0;try{for(var x,b=h.tasks[Symbol.iterator]();!(g=(x=b.next()).done);g=!0){var j,_=x.value,w=null!==(j=a[_.name])&&void 0!==j?j:0;v[_.name]=w,p+=w}}catch(E){m=!0,y=E}finally{try{g||null==b.return||b.return()}finally{if(m)throw y}}n[h.id]={node:h,score:p,badge:c(p,h.tasks.length),tasks:v}}}catch(E){l=!0,u=E}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}var k=new Set,N=function(e){if(!k.has(e)){k.add(e);var r=n[e],a=!1,s=!0,c=!1,l=void 0;try{for(var u,d=r.node.prerequisites[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var f=u.value;N(f);var h=n[f],p=h.node.tasks.length*o*i;("locked"===h.badge||h.score<p)&&(a=!0)}}catch(E){c=!0,l=E}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}a&&!t&&(r.badge="locked")}},S=!0,O=!1,P=void 0;try{for(var A,C=e.nodes[Symbol.iterator]();!(S=(A=C.next()).done);S=!0){var z=A.value;N(z.id)}}catch(E){O=!0,P=E}finally{try{S||null==C.return||C.return()}finally{if(O)throw P}}return n}(a,d,"true"===s.query.unlock);return(0,n.jsxs)("div",{children:[(0,n.jsx)(E,{user:l}),(0,n.jsx)(Q,{badges:m,setSelectedNode:g}),v in m&&(0,n.jsx)(S,{badge:m[v],badges:m})]})}},4408:function(e){e.exports={category:"Category_category__yzdBd",title:"Category_title__8klu6",taskList:"Category_taskList__uYCvW",resources:"Category_resources__dqPOc"}},674:function(e){e.exports={progressNone:"Progress_progressNone__o_ttj",progressBronze:"Progress_progressBronze__TJD81",progressSilver:"Progress_progressSilver__LQ8l3",progressGold:"Progress_progressGold__7qQo3",progress:"Progress_progress__axvfY",checkpoint:"Progress_checkpoint__TZ_n2"}},1829:function(e){e.exports={header:"Header_header__RW35m"}},2914:function(e){e.exports={profilePicture:"ProfilePicture_profilePicture__YaIyJ"}},8707:function(e){e.exports={loading:"Loading_loading__PXEn4"}},5532:function(e){e.exports={line:"Line_line__C9XiF"}},695:function(e){e.exports={tree:"Tree_tree__UfTc3",node:"Tree_node__fgN5z",badge:"Tree_badge__VAWxQ",badgeName:"Tree_badgeName__UP_Ry",score:"Tree_score__RxP9M"}}},function(e){e.O(0,[846,774,888,179],(function(){return r=5301,e(e.s=r);var r}));var r=e.O();_N_E=r}]);